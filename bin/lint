#!/usr/bin/env bash
#
# Copyright 2019 Timely Data, Inc.

set -euo pipefail

cd "$(dirname "$0")/.."

files=$(
    find . '(' -path './target' -o -path './.git' ')' -prune -o -type f \
        | sed 's,^.\/,,' \
        | grep -vE '^\.git$|^\.gitignore$|^Cargo\.lock$|(^|/)Cargo\.toml$|^README.md$|^LICENSE$'
)

run() {
    xargs "$@" <<< "$files"
}

run -n1 awk -f misc/lint/copyright.awk