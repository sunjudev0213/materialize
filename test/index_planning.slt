# Copyright 2020 Materialize, Inc. All rights reserved.
#
# This file is part of Materialize. Materialize may not be used or
# distributed without the express permission of Materialize, Inc.

statement ok
create table foo (
    a int NOT NULL,
    b varchar,
    c decimal(13, 1)
)

statement ok
INSERT INTO foo (a, b, c) VALUES (5, 'this', -4.4), (3, 'just', 11.32), (-45, 'it', 10.28)

query T multiline
explain plan for select b, c from foo where a = 5
----
Project {
  outputs: [1, 2],
  Filter { predicates: [#0 = 5], Get { foo (u1) } }
}

statement ok
create index foo_idx on foo(a);

query T multiline
explain plan for select b, c from foo where a = 5
----
Project {
  outputs: [1, 2],
  Join {
    variables: [[(0, 0), (1, 0)]],
    ArrangeBy { columns: [#0], Get { foo (u1) } },
    Constant [[5]]
  }
}

query T multiline
explain plan for select b, c from foo where a = 5 and b = 'this'
----
Project {
  outputs: [1, 2],
  Filter {
    predicates: [#1 = \"this\"],
    Join {
      variables: [[(0, 0), (1, 0)]],
      ArrangeBy { columns: [#0], Get { foo (u1) } },
      Constant [[5]]
    }
  }
}

statement ok
create index foo_idx2 on foo(b, a);

query T multiline
explain plan for select b, c from foo where a = 5 and b = 'this'
----
Project {
  outputs: [1, 2],
  Join {
    variables: [[(0, 1), (1, 0)], [(0, 0), (1, 1)]],
    ArrangeBy { columns: [#1, #0], Get { foo (u1) } },
    Constant [[\"this\", 5]]
  }
}
