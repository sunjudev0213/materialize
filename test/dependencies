# Copyright 2019 Materialize, Inc. All rights reserved.
#
# This file is part of Materialize. Materialize may not be used or
# distributed without the express permission of Materialize, Inc.

> CREATE MATERIALIZED VIEW test1 AS SELECT 1;

> CREATE MATERIALIZED VIEW test2 AS SELECT * FROM test1;

> CREATE MATERIALIZED VIEW test3a AS SELECT * FROM test2;

> CREATE MATERIALIZED VIEW test3b AS SELECT * FROM test2;

! DROP MATERIALIZED VIEW test1;
cannot delete test1: still depended upon by dataflow 'test2'

! DROP MATERIALIZED VIEW test2;
cannot delete test2: still depended upon by dataflow 'test3a'

> DROP MATERIALIZED VIEW test3a;

! DROP MATERIALIZED VIEW test1;
cannot delete test1: still depended upon by dataflow 'test2'

! DROP MATERIALIZED VIEW test2;
cannot delete test2: still depended upon by dataflow 'test3b'

> DROP MATERIALIZED VIEW test3b;

! DROP MATERIALIZED VIEW test1;
cannot delete test1: still depended upon by dataflow 'test2'

> DROP MATERIALIZED VIEW test2;

> DROP MATERIALIZED VIEW test1;
