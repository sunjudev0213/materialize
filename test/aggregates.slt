# Copyright 2019 Materialize, Inc. All rights reserved.
#
# This file is part of Materialize. Materialize may not be used or
# distributed without the express permission of Materialize, Inc.

mode cockroach

statement ok
CREATE TABLE t (a int, b int)

statement ok
INSERT INTO t (a, b) VALUES (1, 1), (1, 2), (2, 3), (3, 1)

statement error aggregate functions are not allowed in WHERE clause
SELECT a FROM t WHERE sum(b) = 3 GROUP BY a;

query III colnames
SELECT 1 AS literal, sum(a) as sum_a, sum(b) FROM t
----
literal  sum_a  sum
1        7      7

query I rowsort
SELECT a FROM t GROUP BY a HAVING sum(b) = 3;
----
1
2

query TTT colnames
SHOW COLUMNS FROM t
----
 Field Nullable Type
 a     YES      i64
 b     YES      i64
